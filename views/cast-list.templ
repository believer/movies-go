package views

import (
	"believer/movies/components/link"
	"believer/movies/components/list"
	"believer/movies/components/section"
	"believer/movies/components/separator"
	"believer/movies/utils"
	"fmt"
)

type CastAndCrewDTO struct {
	Name      string
	ID        int32
	Character string
}

func (p CastAndCrewDTO) LinkTo() templ.SafeURL {
	return templ.URL(fmt.Sprintf("/person/%s-%d", utils.Slugify(p.Name), p.ID))
}

type CastDTO struct {
	Job    string
	People []CastAndCrewDTO
}

templ CastList(castOrCrew []CastDTO, hasCharacters bool) {
	<div class="movie">
		for _, job := range castOrCrew {
			@section.Section(section.Props{Title: job.Job}) {
				@list.Ol() {
					for _, person := range job.People {
						@list.Li(list.LiProps{Class: "wrapped"}) {
							@link.Link(link.Props{Href: person.LinkTo(), Class: "whitespace-nowrap"}) {
								{ person.Name }
							}
							if person.Character != "" {
								@separator.Separator()
								<div class="trailing">{ person.Character }</div>
							}
						}
					}
				}
			}
		}
	</div>
}
